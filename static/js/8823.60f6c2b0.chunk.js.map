{"version":3,"file":"static/js/8823.60f6c2b0.chunk.js","mappings":"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","sources":["Informes/formulario/zExcelUploaderStoragePrecargaxDefecto copy.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n    Button,\n    Box,\n    Typography,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    Link,\n} from \"@mui/material\";\nimport * as XLSX from \"xlsx\";\nimport TuneIcon from '@mui/icons-material/Tune';\n\nconst ExcelUploaderStorage = ({ open, handleOpen, handleClose }) => {\n    const [sheets, setSheets] = useState(null);\n    const [dragOver, setDragOver] = useState(false);\n\n    // Cargar plantilla por defecto desde sessionStorage o archivo local\n    useEffect(() => {\n        // Si ya existen datos en sessionStorage, los cargamos\n        const storedData = sessionStorage.getItem(\"excelData\");\n        if (!storedData) {\n            // Si no hay datos, cargamos la plantilla por defecto desde el archivo\n            fetch(\"/plantillasParametros/caes.xlsx\")\n                .then((response) => response.arrayBuffer())\n                .then((data) => {\n                    const workbook = XLSX.read(data, { type: \"array\" });\n                    const sheetsData = {};\n\n                    workbook.SheetNames.forEach((sheetName) => {\n                        const sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], {\n                            header: 1, // Mantiene la primera fila como encabezados\n                        });\n\n                        // Filtrar filas vacías\n                        const filteredSheet = sheet.filter((row) =>\n                            row.some((cell) => cell !== null && cell !== undefined && cell !== \"\")\n                        );\n\n                        sheetsData[sheetName] = filteredSheet;\n                    });\n\n                    // Guardar los datos procesados en sessionStorage\n                    sessionStorage.setItem(\"excelData\", JSON.stringify(sheetsData));\n                    setSheets(sheetsData);\n                })\n                .catch((error) => {\n                    console.error(\"Error al cargar la plantilla por defecto:\", error);\n                });\n        } else {\n            setSheets(JSON.parse(storedData));\n        }\n    }, []);\n\n    const handleFileUpload = (file) => {\n        if (!file) return;\n\n        // Limpia la clave 'excelData' de sessionStorage\n        sessionStorage.removeItem(\"excelData\");\n\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            const data = new Uint8Array(e.target.result);\n            const workbook = XLSX.read(data, { type: \"array\" });\n            const sheetsData = {};\n\n            // Procesar cada hoja y convertirla en JSON\n            workbook.SheetNames.forEach((sheetName) => {\n                const sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], {\n                    header: 1, // Mantiene la primera fila como encabezados\n                });\n\n                // Filtrar filas vacías\n                const filteredSheet = sheet.filter((row) =>\n                    row.some((cell) => cell !== null && cell !== undefined && cell !== \"\")\n                );\n\n                sheetsData[sheetName] = filteredSheet;\n            });\n\n            // Guardar los datos procesados en el estado y en sessionStorage\n            setSheets(sheetsData);\n            sessionStorage.setItem(\"excelData\", JSON.stringify(sheetsData));\n        };\n\n        reader.readAsArrayBuffer(file);\n    };\n\n    const handleInputChange = (event) => {\n        const file = event.target.files[0];\n        handleFileUpload(file);\n    };\n\n    const handleDragOver = (event) => {\n        event.preventDefault();\n        setDragOver(true);\n    };\n\n    const handleDragLeave = () => {\n        setDragOver(false);\n    };\n\n    const handleDrop = (event) => {\n        event.preventDefault();\n        setDragOver(false);\n        const file = event.dataTransfer.files[0];\n        handleFileUpload(file);\n    };\n\n    return (\n        <Box sx={{ p: 2 }}>\n            <Dialog open={open} onClose={handleClose} fullWidth maxWidth=\"sm\">\n                <DialogTitle>Subir archivo Excel de parámetros</DialogTitle>\n                <DialogContent>\n                    <Box\n                        sx={{\n                            mt: 2,\n                            p: 2,\n                            border: \"2px dashed\",\n                            borderColor: dragOver ? \"primary.main\" : \"grey.400\",\n                            borderRadius: 2,\n                            textAlign: \"center\",\n                            backgroundColor: dragOver ? \"grey.100\" : \"transparent\",\n                        }}\n                        onDragOver={handleDragOver}\n                        onDragLeave={handleDragLeave}\n                        onDrop={handleDrop}\n                    >\n                        <Typography variant=\"body1\" gutterBottom>\n                            Arrastra y suelta tu archivo aquí o selecciona uno manualmente\n                        </Typography>\n                        <Button variant=\"contained\" component=\"label\">\n                            Seleccionar Archivo\n                            <input\n                                type=\"file\"\n                                hidden\n                                accept=\".xlsx, .xls\"\n                                onChange={handleInputChange}\n                            />\n                        </Button>\n                    </Box>\n                    <Box sx={{ mt: 2 }}>\n                        <Typography variant=\"body2\">\n                            ¿Necesitas una plantilla? Descárgala haciendo clic\n                            <Link href=\"/plantillasParametros/caes.xlsx\" download sx={{ ml: 1 }}>\n                                aquí\n                            </Link>\n                            .\n                        </Typography>\n                    </Box>\n                    {sheets && (\n                        <Box sx={{ mt: 2 }}>\n                            <Typography variant=\"subtitle1\">Hojas procesadas:</Typography>\n                            <ul>\n                                {Object.keys(sheets).map((sheetName) => (\n                                    <li key={sheetName}>{sheetName}</li>\n                                ))}\n                            </ul>\n                        </Box>\n                    )}\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleClose} color=\"primary\">\n                        Cerrar\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </Box>\n    );\n};\n\nexport default ExcelUploaderStorage;\n"],"names":["_ref","open","handleOpen","handleClose","sheets","setSheets","useState","dragOver","setDragOver","useEffect","storedData","sessionStorage","getItem","JSON","parse","fetch","then","response","arrayBuffer","data","workbook","XLSX","type","sheetsData","SheetNames","forEach","sheetName","filteredSheet","sheet_to_json","Sheets","header","filter","row","some","cell","undefined","setItem","stringify","catch","error","console","handleFileUpload","file","removeItem","reader","FileReader","onload","e","Uint8Array","target","result","readAsArrayBuffer","_jsx","Box","sx","p","children","_jsxs","Dialog","onClose","fullWidth","maxWidth","DialogTitle","DialogContent","mt","border","borderColor","borderRadius","textAlign","backgroundColor","onDragOver","event","preventDefault","onDragLeave","handleDragLeave","onDrop","dataTransfer","files","Typography","variant","gutterBottom","Button","component","hidden","accept","onChange","Link","href","download","ml","Object","keys","map","DialogActions","onClick","color"],"sourceRoot":""}